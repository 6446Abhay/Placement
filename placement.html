<script>
    async function loadExcel() {
        const storedData = localStorage.getItem("uploadedExcel");
        if (!storedData) {
            alert("No Excel file uploaded. Please upload one in the Admin Panel.");
            return;
        }

        const workbook = XLSX.read(storedData, { type: "binary" });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const data = XLSX.utils.sheet_to_json(sheet);

        const container = document.getElementById("photo-container");
        container.innerHTML = ""; // Clear old content

        data.forEach(item => {
            const card = document.createElement("div");
            card.className = "photo-card";
            card.innerHTML = `
                <img src="${item['Image URL']}" alt="${item['School Name']}">
                <p><strong>School Name:</strong> ${item['School Name']}</p>
                <p><strong>Placement Available:</strong> ${item['Placement Available']}</p>
                <p><strong>Contact No:</strong> ${item['Contact No']}</p>
            `;
            container.appendChild(card);
        });
    }

    loadExcel(); // Load the uploaded Excel file when the page opens
</script>
